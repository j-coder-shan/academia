<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evaluation - Academia LMS</title>
    <link rel="stylesheet" href="../../css/style.css">
    <link rel="stylesheet" href="../../css/dashboard.css">
    <link rel="icon" type="image/x-icon" href="../../assets/favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="dashboard-container">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <i class="fas fa-graduation-cap"></i>
                    <h1>Academia LMS</h1>
                </div>
            </div>
            
            <div class="user-info">
                <div class="user-avatar">
                    <i class="fas fa-chalkboard-teacher"></i>
                </div>
                <div class="user-name" id="userName">Loading...</div>
                <div class="user-role">Lecturer</div>
            </div>
            
            <nav class="nav-menu">
                <div class="nav-item">
                    <a href="dashboard.html" class="nav-link">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="courses.html" class="nav-link">
                        <i class="fas fa-book-open"></i>
                        <span>Courses</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="manage-courses.html" class="nav-link">
                        <i class="fas fa-cogs"></i>
                        <span>Manage Courses</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="presentations.html" class="nav-link">
                        <i class="fas fa-tv"></i>
                        <span>Presentations</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="assignments.html" class="nav-link">
                        <i class="fas fa-tasks"></i>
                        <span>Assignments</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="evaluation.html" class="nav-link active">
                        <i class="fas fa-clipboard-check"></i>
                        <span>Evaluations</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="calendar.html" class="nav-link">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Calendar</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="profile.html" class="nav-link">
                        <i class="fas fa-user"></i>
                        <span>Profile</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="settings.html" class="nav-link">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </a>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <h2 class="header-title">Student Evaluations</h2>
                </div>
                <div class="header-actions">
                    <button class="header-btn" title="Notifications">
                        <i class="fas fa-bell"></i>
                    </button>
                    <button class="header-btn" id="logoutBtn" title="Logout">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </header>

            <!-- Content -->
            <div class="content">
                <div class="evaluation-header">
                    <div class="evaluation-controls">
                        <button class="btn btn-secondary" id="bulkGradeBtn">Bulk Grade</button>
                        <button class="btn btn-secondary" id="exportGradesBtn">Export Grades</button>
                    </div>
                    <div class="evaluation-stats">
                        <span class="stat"><strong id="pendingCount">15</strong> Pending</span>
                        <span class="stat"><strong id="completedCount">42</strong> Completed</span>
                    </div>
                </div>
                </div>
            </header>

            <!-- Evaluation Filters -->
            <div class="evaluation-filters">
                <div class="filter-group">
                    <label for="courseFilter">Course:</label>
                    <select id="courseFilter">
                        <option value="">All Courses</option>
                        <option value="cs101">Computer Science I</option>
                        <option value="ds101">Data Structures</option>
                        <option value="ap101">Advanced Programming</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="assignmentFilter">Assignment:</label>
                    <select id="assignmentFilter">
                        <option value="">All Assignments</option>
                        <option value="pa1">Programming Assignment 1</option>
                        <option value="q1">Quiz 1</option>
                        <option value="p1">Project 1</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="statusFilter">Status:</label>
                    <select id="statusFilter">
                        <option value="">All</option>
                        <option value="pending">Pending</option>
                        <option value="graded">Graded</option>
                        <option value="returned">Returned</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="studentSearch">Search Student:</label>
                    <input type="text" id="studentSearch" placeholder="Search by name or ID...">
                </div>
            </div>

            <!-- Evaluation List -->
            <div class="evaluations-container">
                <!-- Pending Evaluations -->
                <div class="evaluation-item pending" data-evaluation-id="eval1">
                    <div class="evaluation-header">
                        <div class="student-info">
                            <h3>John Doe</h3>
                            <p>Student ID: STU2025001</p>
                        </div>
                        <div class="assignment-info">
                            <h4>Programming Assignment 1</h4>
                            <p>Computer Science I</p>
                        </div>
                        <div class="submission-info">
                            <p><strong>Submitted:</strong> Jan 10, 2025, 2:30 PM</p>
                            <p><strong>Due:</strong> Jan 12, 2025, 11:59 PM</p>
                            <span class="submission-status on-time">On Time</span>
                        </div>
                        <div class="evaluation-actions">
                            <button class="btn" onclick="evaluateSubmission('eval1')">Grade</button>
                            <button class="btn btn-secondary" onclick="previewSubmission('eval1')">Preview</button>
                        </div>
                    </div>
                </div>

                <div class="evaluation-item pending" data-evaluation-id="eval2">
                    <div class="evaluation-header">
                        <div class="student-info">
                            <h3>Jane Smith</h3>
                            <p>Student ID: STU2025002</p>
                        </div>
                        <div class="assignment-info">
                            <h4>Quiz 1: Variables and Data Types</h4>
                            <p>Computer Science I</p>
                        </div>
                        <div class="submission-info">
                            <p><strong>Submitted:</strong> Jan 11, 2025, 9:15 AM</p>
                            <p><strong>Due:</strong> Jan 12, 2025, 11:59 PM</p>
                            <span class="submission-status on-time">On Time</span>
                        </div>
                        <div class="evaluation-actions">
                            <button class="btn" onclick="evaluateSubmission('eval2')">Grade</button>
                            <button class="btn btn-secondary" onclick="previewSubmission('eval2')">Preview</button>
                        </div>
                    </div>
                </div>

                <div class="evaluation-item pending" data-evaluation-id="eval3">
                    <div class="evaluation-header">
                        <div class="student-info">
                            <h3>Bob Johnson</h3>
                            <p>Student ID: STU2025003</p>
                        </div>
                        <div class="assignment-info">
                            <h4>Programming Assignment 1</h4>
                            <p>Data Structures</p>
                        </div>
                        <div class="submission-info">
                            <p><strong>Submitted:</strong> Jan 12, 2025, 11:45 PM</p>
                            <p><strong>Due:</strong> Jan 12, 2025, 11:59 PM</p>
                            <span class="submission-status late">Late (14 mins)</span>
                        </div>
                        <div class="evaluation-actions">
                            <button class="btn" onclick="evaluateSubmission('eval3')">Grade</button>
                            <button class="btn btn-secondary" onclick="previewSubmission('eval3')">Preview</button>
                        </div>
                    </div>
                </div>

                <!-- Completed Evaluations -->
                <div class="evaluation-item graded" data-evaluation-id="eval4">
                    <div class="evaluation-header">
                        <div class="student-info">
                            <h3>Alice Wilson</h3>
                            <p>Student ID: STU2025004</p>
                        </div>
                        <div class="assignment-info">
                            <h4>Programming Assignment 1</h4>
                            <p>Computer Science I</p>
                        </div>
                        <div class="submission-info">
                            <p><strong>Submitted:</strong> Jan 9, 2025, 4:20 PM</p>
                            <p><strong>Graded:</strong> Jan 11, 2025, 10:30 AM</p>
                            <span class="grade-badge">A- (92%)</span>
                        </div>
                        <div class="evaluation-actions">
                            <button class="btn btn-secondary" onclick="reviewGrade('eval4')">Review</button>
                            <button class="btn btn-secondary" onclick="viewFeedback('eval4')">Feedback</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pagination -->
            <div class="pagination">
                <button class="btn btn-secondary" disabled>Previous</button>
                <span class="page-info">Page 1 of 3</span>
                <button class="btn btn-secondary">Next</button>
            </div>
        </main>
    </div>

    <!-- Evaluation Modal -->
    <div id="evaluationModal" class="modal hidden">
        <div class="modal-content large">
            <div class="modal-header">
                <h2 id="evaluationTitle">Grade Assignment</h2>
                <button class="modal-close" id="closeEvaluationModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="evaluation-workspace">
                    <!-- Student and Assignment Info -->
                    <div class="evaluation-info">
                        <div class="student-details">
                            <h3 id="modalStudentName">John Doe</h3>
                            <p id="modalStudentId">Student ID: STU2025001</p>
                        </div>
                        <div class="assignment-details">
                            <h4 id="modalAssignmentTitle">Programming Assignment 1</h4>
                            <p id="modalCourse">Computer Science I</p>
                            <p id="modalSubmissionDate">Submitted: Jan 10, 2025, 2:30 PM</p>
                        </div>
                    </div>

                    <!-- Submission Content -->
                    <div class="submission-content">
                        <div class="content-tabs">
                            <button class="content-tab active" data-tab="submission">Submission</button>
                            <button class="content-tab" data-tab="rubric">Rubric</button>
                            <button class="content-tab" data-tab="history">History</button>
                        </div>

                        <div id="submission" class="content-panel active">
                            <div class="submission-files">
                                <h5>Submitted Files</h5>
                                <div class="file-list">
                                    <div class="file-item">
                                        <span class="file-icon">📄</span>
                                        <span class="file-name">main.py</span>
                                        <button class="btn btn-small" onclick="downloadFile('main.py')">Download</button>
                                        <button class="btn btn-small" onclick="viewFile('main.py')">View</button>
                                    </div>
                                    <div class="file-item">
                                        <span class="file-icon">📄</span>
                                        <span class="file-name">readme.txt</span>
                                        <button class="btn btn-small" onclick="downloadFile('readme.txt')">Download</button>
                                        <button class="btn btn-small" onclick="viewFile('readme.txt')">View</button>
                                    </div>
                                </div>
                            </div>

                            <div class="submission-text">
                                <h5>Student Comments</h5>
                                <div class="student-comments">
                                    <p>This is my implementation of the calculator program as requested. I've included error handling for division by zero and implemented all required operations.</p>
                                </div>
                            </div>

                            <div class="code-viewer">
                                <h5>Code Preview</h5>
                                <div class="code-container">
                                    <pre><code>
# Simple Calculator Program
# John Doe - STU2025001

def add(x, y):
    return x + y

def subtract(x, y):
    return x - y

def multiply(x, y):
    return x * y

def divide(x, y):
    if y == 0:
        return "Error: Division by zero"
    return x / y

# Main program
while True:
    print("Select operation:")
    print("1. Add")
    print("2. Subtract")
    print("3. Multiply")
    print("4. Divide")
    print("5. Exit")
    
    choice = input("Enter choice (1/2/3/4/5): ")
    
    if choice == '5':
        break
    
    if choice in ['1', '2', '3', '4']:
        num1 = float(input("Enter first number: "))
        num2 = float(input("Enter second number: "))
        
        if choice == '1':
            print(f"Result: {add(num1, num2)}")
        elif choice == '2':
            print(f"Result: {subtract(num1, num2)}")
        elif choice == '3':
            print(f"Result: {multiply(num1, num2)}")
        elif choice == '4':
            print(f"Result: {divide(num1, num2)}")
    else:
        print("Invalid input")
                                    </code></pre>
                                </div>
                            </div>
                        </div>

                        <div id="rubric" class="content-panel">
                            <div class="rubric-sections">
                                <div class="rubric-section">
                                    <h5>Code Quality (25 points)</h5>
                                    <div class="rubric-criteria">
                                        <label>
                                            <input type="radio" name="code_quality" value="25"> Excellent (23-25 pts): Clean, well-organized code
                                        </label>
                                        <label>
                                            <input type="radio" name="code_quality" value="20" checked> Good (20-22 pts): Mostly clean code with minor issues
                                        </label>
                                        <label>
                                            <input type="radio" name="code_quality" value="15"> Fair (15-19 pts): Acceptable code with some issues
                                        </label>
                                        <label>
                                            <input type="radio" name="code_quality" value="10"> Poor (10-14 pts): Poorly organized code
                                        </label>
                                    </div>
                                </div>

                                <div class="rubric-section">
                                    <h5>Functionality (40 points)</h5>
                                    <div class="rubric-criteria">
                                        <label>
                                            <input type="radio" name="functionality" value="40" checked> Excellent (36-40 pts): All requirements met perfectly
                                        </label>
                                        <label>
                                            <input type="radio" name="functionality" value="30"> Good (30-35 pts): Most requirements met
                                        </label>
                                        <label>
                                            <input type="radio" name="functionality" value="20"> Fair (20-29 pts): Some requirements met
                                        </label>
                                        <label>
                                            <input type="radio" name="functionality" value="10"> Poor (10-19 pts): Few requirements met
                                        </label>
                                    </div>
                                </div>

                                <div class="rubric-section">
                                    <h5>Error Handling (20 points)</h5>
                                    <div class="rubric-criteria">
                                        <label>
                                            <input type="radio" name="error_handling" value="20" checked> Excellent (18-20 pts): Comprehensive error handling
                                        </label>
                                        <label>
                                            <input type="radio" name="error_handling" value="15"> Good (15-17 pts): Good error handling
                                        </label>
                                        <label>
                                            <input type="radio" name="error_handling" value="10"> Fair (10-14 pts): Basic error handling
                                        </label>
                                        <label>
                                            <input type="radio" name="error_handling" value="5"> Poor (5-9 pts): Little to no error handling
                                        </label>
                                    </div>
                                </div>

                                <div class="rubric-section">
                                    <h5>Documentation (15 points)</h5>
                                    <div class="rubric-criteria">
                                        <label>
                                            <input type="radio" name="documentation" value="15"> Excellent (14-15 pts): Excellent comments and documentation
                                        </label>
                                        <label>
                                            <input type="radio" name="documentation" value="12" checked> Good (12-13 pts): Good comments
                                        </label>
                                        <label>
                                            <input type="radio" name="documentation" value="8"> Fair (8-11 pts): Some comments
                                        </label>
                                        <label>
                                            <input type="radio" name="documentation" value="5"> Poor (5-7 pts): Minimal comments
                                        </label>
                                    </div>
                                </div>

                                <div class="rubric-total">
                                    <h4>Total Score: <span id="totalScore">92</span>/100</h4>
                                    <p>Grade: <span id="letterGrade">A-</span></p>
                                </div>
                            </div>
                        </div>

                        <div id="history" class="content-panel">
                            <div class="submission-history">
                                <h5>Submission History</h5>
                                <div class="history-item">
                                    <p><strong>Jan 10, 2025, 2:30 PM</strong> - Initial submission</p>
                                    <p>Files: main.py, readme.txt</p>
                                </div>
                                <div class="history-item">
                                    <p><strong>Jan 9, 2025, 8:45 PM</strong> - Draft saved</p>
                                    <p>Files: main.py</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Grading Panel -->
                    <div class="grading-panel">
                        <div class="grade-input">
                            <label for="gradeScore">Score:</label>
                            <input type="number" id="gradeScore" min="0" max="100" value="92">
                            <span>/100</span>
                        </div>

                        <div class="grade-letter">
                            <label for="gradeLetter">Letter Grade:</label>
                            <select id="gradeLetter">
                                <option value="A+">A+ (97-100)</option>
                                <option value="A">A (93-96)</option>
                                <option value="A-" selected>A- (90-92)</option>
                                <option value="B+">B+ (87-89)</option>
                                <option value="B">B (83-86)</option>
                                <option value="B-">B- (80-82)</option>
                                <option value="C+">C+ (77-79)</option>
                                <option value="C">C (73-76)</option>
                                <option value="C-">C- (70-72)</option>
                                <option value="D">D (60-69)</option>
                                <option value="F">F (0-59)</option>
                            </select>
                        </div>

                        <div class="feedback-section">
                            <label for="feedbackText">Feedback:</label>
                            <textarea id="feedbackText" rows="6" placeholder="Provide detailed feedback to the student...">Excellent work on implementing the calculator program. Your code is well-structured and handles all the basic operations correctly. The error handling for division by zero is properly implemented. 

Areas for improvement:
- Consider adding input validation for non-numeric inputs
- The code formatting could be slightly improved with consistent spacing

Overall, this is a solid implementation that meets all the requirements. Great job!</textarea>
                        </div>

                        <div class="grading-options">
                            <label>
                                <input type="checkbox" id="returnToStudent" checked>
                                Return graded assignment to student
                            </label>
                            <label>
                                <input type="checkbox" id="sendNotification" checked>
                                Send notification email
                            </label>
                            <label>
                                <input type="checkbox" id="allowResubmission">
                                Allow resubmission
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" id="saveGradeBtn">Save Grade</button>
                <button class="btn btn-secondary" id="saveDraftBtn">Save as Draft</button>
                <button class="btn btn-secondary" id="cancelGradeBtn">Cancel</button>
            </div>
        </div>
    </div>

    <script src="../../js/auth.js"></script>
    <script src="../../js/lecturer-navigation.js"></script>
    <script src="../../js/lecturer-evaluation.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            initializeEvaluation();
            bindEvents();
        });

        function initializeEvaluation() {
            loadEvaluations();
            updateCounts();
        }

        function bindEvents() {
            // Filter events
            document.getElementById('courseFilter').addEventListener('change', applyFilters);
            document.getElementById('assignmentFilter').addEventListener('change', applyFilters);
            document.getElementById('statusFilter').addEventListener('change', applyFilters);
            document.getElementById('studentSearch').addEventListener('input', applyFilters);

            // Modal events
            document.getElementById('closeEvaluationModal').addEventListener('click', () => hideModal('evaluationModal'));
            document.getElementById('saveGradeBtn').addEventListener('click', saveGrade);
            document.getElementById('saveDraftBtn').addEventListener('click', saveDraft);
            document.getElementById('cancelGradeBtn').addEventListener('click', () => hideModal('evaluationModal'));

            // Content tabs
            document.querySelectorAll('.content-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    switchContentTab(this.dataset.tab);
                });
            });

            // Rubric calculations
            document.querySelectorAll('input[type="radio"]').forEach(radio => {
                radio.addEventListener('change', calculateRubricScore);
            });

            // Grade input sync
            document.getElementById('gradeScore').addEventListener('input', updateLetterGrade);
            document.getElementById('gradeLetter').addEventListener('change', updateNumericGrade);
        }

        function loadEvaluations() {
            // This would load from API in a real application
            console.log('Loading evaluations...');
        }

        function updateCounts() {
            // Update pending and completed counts
            const pendingEvaluations = document.querySelectorAll('.evaluation-item.pending').length;
            const completedEvaluations = document.querySelectorAll('.evaluation-item.graded').length;
            
            document.getElementById('pendingCount').textContent = pendingEvaluations;
            document.getElementById('completedCount').textContent = completedEvaluations;
        }

        function applyFilters() {
            const courseFilter = document.getElementById('courseFilter').value;
            const assignmentFilter = document.getElementById('assignmentFilter').value;
            const statusFilter = document.getElementById('statusFilter').value;
            const searchTerm = document.getElementById('studentSearch').value.toLowerCase();

            const evaluations = document.querySelectorAll('.evaluation-item');
            
            evaluations.forEach(evaluation => {
                let show = true;

                // Apply filters (simplified for demo)
                if (searchTerm) {
                    const studentName = evaluation.querySelector('h3').textContent.toLowerCase();
                    if (!studentName.includes(searchTerm)) {
                        show = false;
                    }
                }

                if (statusFilter) {
                    if (!evaluation.classList.contains(statusFilter)) {
                        show = false;
                    }
                }

                evaluation.style.display = show ? 'block' : 'none';
            });
        }

        function evaluateSubmission(evaluationId) {
            // Load submission data
            loadSubmissionData(evaluationId);
            showModal('evaluationModal');
        }

        function previewSubmission(evaluationId) {
            // Open submission in preview mode
            alert(`Preview submission ${evaluationId}`);
        }

        function loadSubmissionData(evaluationId) {
            // This would load specific submission data from API
            console.log(`Loading submission data for ${evaluationId}`);
            
            // Update modal content based on submission
            document.getElementById('evaluationTitle').textContent = 'Grade Assignment - Programming Assignment 1';
        }

        function switchContentTab(tabName) {
            // Update active tab
            document.querySelectorAll('.content-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            
            // Show corresponding panel
            document.querySelectorAll('.content-panel').forEach(panel => panel.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
        }

        function calculateRubricScore() {
            const sections = ['code_quality', 'functionality', 'error_handling', 'documentation'];
            let total = 0;

            sections.forEach(section => {
                const selected = document.querySelector(`input[name="${section}"]:checked`);
                if (selected) {
                    total += parseInt(selected.value);
                }
            });

            document.getElementById('totalScore').textContent = total;
            document.getElementById('gradeScore').value = total;
            
            // Update letter grade
            updateLetterGrade();
        }

        function updateLetterGrade() {
            const score = parseInt(document.getElementById('gradeScore').value);
            let letterGrade = 'F';

            if (score >= 97) letterGrade = 'A+';
            else if (score >= 93) letterGrade = 'A';
            else if (score >= 90) letterGrade = 'A-';
            else if (score >= 87) letterGrade = 'B+';
            else if (score >= 83) letterGrade = 'B';
            else if (score >= 80) letterGrade = 'B-';
            else if (score >= 77) letterGrade = 'C+';
            else if (score >= 73) letterGrade = 'C';
            else if (score >= 70) letterGrade = 'C-';
            else if (score >= 60) letterGrade = 'D';

            document.getElementById('gradeLetter').value = letterGrade;
            document.getElementById('letterGrade').textContent = letterGrade;
        }

        function updateNumericGrade() {
            const letterGrade = document.getElementById('gradeLetter').value;
            let score = 0;

            const gradeMap = {
                'A+': 98, 'A': 95, 'A-': 92,
                'B+': 88, 'B': 85, 'B-': 82,
                'C+': 78, 'C': 75, 'C-': 72,
                'D': 65, 'F': 50
            };

            score = gradeMap[letterGrade] || 0;
            document.getElementById('gradeScore').value = score;
            document.getElementById('letterGrade').textContent = letterGrade;
        }

        async function saveGrade() {
            const gradeData = {
                score: document.getElementById('gradeScore').value,
                letterGrade: document.getElementById('gradeLetter').value,
                feedback: document.getElementById('feedbackText').value,
                returnToStudent: document.getElementById('returnToStudent').checked,
                sendNotification: document.getElementById('sendNotification').checked,
                allowResubmission: document.getElementById('allowResubmission').checked
            };

            try {
                // This would be an API call in a real application
                console.log('Saving grade:', gradeData);
                
                hideModal('evaluationModal');
                showAlert('Grade saved successfully!', 'success');
                
                // Update the evaluation item in the list
                updateEvaluationStatus();
                updateCounts();
                
            } catch (error) {
                console.error('Error saving grade:', error);
                showAlert('Error saving grade', 'error');
            }
        }

        function saveDraft() {
            const draftData = {
                score: document.getElementById('gradeScore').value,
                feedback: document.getElementById('feedbackText').value,
                isDraft: true
            };

            try {
                console.log('Saving draft:', draftData);
                showAlert('Draft saved successfully!', 'success');
            } catch (error) {
                console.error('Error saving draft:', error);
                showAlert('Error saving draft', 'error');
            }
        }

        function updateEvaluationStatus() {
            // Update the evaluation item to show it's been graded
            // This is a simplified version - in a real app, you'd reload the data
        }

        function downloadFile(filename) {
            // This would download the file
            alert(`Downloading ${filename}`);
        }

        function viewFile(filename) {
            // This would open the file in a viewer
            alert(`Viewing ${filename}`);
        }

        function showModal(modalId) {
            document.getElementById(modalId).classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function hideModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        function showAlert(message, type = 'info') {
            // Remove existing alerts
            const existingAlert = document.querySelector('.alert');
            if (existingAlert) {
                existingAlert.remove();
            }

            // Create new alert
            const alert = document.createElement('div');
            alert.className = `alert alert-${type}`;
            alert.textContent = message;

            // Insert alert at the top of main content
            const mainContent = document.querySelector('.main-content');
            if (mainContent) {
                mainContent.insertBefore(alert, mainContent.firstChild);
            }

            // Auto-remove alert after 3 seconds
            setTimeout(() => {
                if (alert.parentNode) {
                    alert.remove();
                }
            }, 3000);
        }

        // Custom styles
        const style = document.createElement('style');
        style.textContent = `
            .evaluation-filters {
                display: flex;
                gap: 20px;
                margin-bottom: 30px;
                flex-wrap: wrap;
            }

            .filter-group {
                display: flex;
                flex-direction: column;
                gap: 5px;
            }

            .filter-group label {
                font-weight: bold;
                font-size: 14px;
            }

            .filter-group select,
            .filter-group input {
                padding: 8px 12px;
                border: 1px solid #ddd;
                border-radius: 4px;
                min-width: 150px;
            }

            .evaluation-item {
                background: white;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                margin-bottom: 20px;
                padding: 20px;
                border-left: 4px solid #ddd;
            }

            .evaluation-item.pending {
                border-left-color: #f39c12;
            }

            .evaluation-item.graded {
                border-left-color: #27ae60;
            }

            .evaluation-header {
                display: grid;
                grid-template-columns: 1fr 1fr 1fr auto;
                gap: 20px;
                align-items: center;
            }

            .student-info h3 {
                margin-bottom: 5px;
                color: #2c3e50;
            }

            .student-info p {
                color: #666;
                font-size: 14px;
            }

            .assignment-info h4 {
                margin-bottom: 5px;
                color: #2c3e50;
            }

            .assignment-info p {
                color: #666;
                font-size: 14px;
            }

            .submission-status {
                padding: 4px 8px;
                border-radius: 4px;
                font-size: 12px;
                font-weight: bold;
                text-transform: uppercase;
            }

            .submission-status.on-time {
                background: #27ae60;
                color: white;
            }

            .submission-status.late {
                background: #e74c3c;
                color: white;
            }

            .grade-badge {
                background: #3498db;
                color: white;
                padding: 6px 12px;
                border-radius: 4px;
                font-weight: bold;
            }

            .evaluation-actions {
                display: flex;
                gap: 10px;
                flex-direction: column;
            }

            .evaluation-workspace {
                display: grid;
                grid-template-columns: 2fr 1fr;
                gap: 30px;
                height: 70vh;
            }

            .evaluation-info {
                display: flex;
                gap: 30px;
                margin-bottom: 20px;
                padding: 15px;
                background: #f8f9fa;
                border-radius: 8px;
            }

            .content-tabs {
                display: flex;
                gap: 10px;
                margin-bottom: 20px;
                border-bottom: 1px solid #eee;
            }

            .content-tab {
                padding: 10px 20px;
                border: none;
                background: none;
                cursor: pointer;
                border-bottom: 2px solid transparent;
            }

            .content-tab.active {
                border-bottom-color: #3498db;
                color: #3498db;
            }

            .content-panel {
                display: none;
                height: calc(70vh - 100px);
                overflow-y: auto;
            }

            .content-panel.active {
                display: block;
            }

            .file-list {
                display: flex;
                flex-direction: column;
                gap: 10px;
                margin-bottom: 20px;
            }

            .file-item {
                display: flex;
                align-items: center;
                gap: 10px;
                padding: 10px;
                border: 1px solid #eee;
                border-radius: 4px;
            }

            .file-icon {
                font-size: 20px;
            }

            .file-name {
                flex: 1;
                font-weight: bold;
            }

            .code-container {
                background: #f8f9fa;
                border: 1px solid #ddd;
                border-radius: 4px;
                padding: 15px;
                overflow-x: auto;
                max-height: 400px;
            }

            .code-container pre {
                margin: 0;
                font-family: 'Courier New', monospace;
                font-size: 14px;
                line-height: 1.4;
            }

            .grading-panel {
                background: #f8f9fa;
                padding: 20px;
                border-radius: 8px;
                height: fit-content;
            }

            .grade-input {
                display: flex;
                align-items: center;
                gap: 10px;
                margin-bottom: 20px;
            }

            .grade-input input {
                width: 80px;
                padding: 8px;
                border: 1px solid #ddd;
                border-radius: 4px;
                text-align: center;
                font-size: 16px;
                font-weight: bold;
            }

            .grade-letter {
                margin-bottom: 20px;
            }

            .grade-letter select {
                width: 100%;
                padding: 8px 12px;
                border: 1px solid #ddd;
                border-radius: 4px;
            }

            .feedback-section {
                margin-bottom: 20px;
            }

            .feedback-section label {
                display: block;
                margin-bottom: 5px;
                font-weight: bold;
            }

            .feedback-section textarea {
                width: 100%;
                padding: 10px;
                border: 1px solid #ddd;
                border-radius: 4px;
                resize: vertical;
                font-family: inherit;
            }

            .grading-options {
                display: flex;
                flex-direction: column;
                gap: 10px;
            }

            .grading-options label {
                display: flex;
                align-items: center;
                gap: 8px;
                font-size: 14px;
            }

            .rubric-sections {
                display: flex;
                flex-direction: column;
                gap: 20px;
            }

            .rubric-section {
                border: 1px solid #ddd;
                border-radius: 8px;
                padding: 15px;
            }

            .rubric-section h5 {
                margin-bottom: 10px;
                color: #2c3e50;
            }

            .rubric-criteria {
                display: flex;
                flex-direction: column;
                gap: 8px;
            }

            .rubric-criteria label {
                display: flex;
                align-items: flex-start;
                gap: 8px;
                font-size: 14px;
                cursor: pointer;
            }

            .rubric-total {
                background: #e8f4fd;
                border: 2px solid #3498db;
                border-radius: 8px;
                padding: 20px;
                text-align: center;
            }

            .rubric-total h4 {
                margin-bottom: 10px;
                color: #2c3e50;
            }

            .pagination {
                display: flex;
                justify-content: center;
                align-items: center;
                gap: 20px;
                margin-top: 30px;
            }

            .evaluation-stats {
                display: flex;
                gap: 20px;
            }

            .evaluation-stats .stat {
                font-size: 14px;
            }

            @media (max-width: 768px) {
                .evaluation-filters {
                    flex-direction: column;
                }

                .evaluation-header {
                    grid-template-columns: 1fr;
                    gap: 15px;
                }

                .evaluation-workspace {
                    grid-template-columns: 1fr;
                    height: auto;
                }

                .evaluation-info {
                    flex-direction: column;
                    gap: 15px;
                }

                .evaluation-actions {
                    flex-direction: row;
                }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
